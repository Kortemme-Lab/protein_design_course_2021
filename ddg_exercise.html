
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ΔΔG Exercise &#8212; Computational Protein Design Minicourse</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Additional Readings" href="papers.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Computational Protein Design Minicourse</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="schedule.html">
   Course Schedule
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="ligand_recognition.html">
   Ligand Recognition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="_intro.html">
   Homepage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_LigandDesign.html">
   Ligand Binding Site Design Exercise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="installation_instructions.html">
   Installing Course Prerequisites
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_RosettaDesign.html">
   Rosetta Design
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="00_getting_started_with_rosetta.html">
   Getting started with PyRosetta and PyMOL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="accessing_the_course.html">
   Accessing the course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="papers.html">
   Additional Readings
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   ΔΔG Exercise
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/ddg_exercise.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/ddg_exercise.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="g-exercise">
<h1>ΔΔG Exercise<a class="headerlink" href="#g-exercise" title="Permalink to this headline">¶</a></h1>
<p>A classical technique in protein biochemisty and protein engineering is to describe a mutant protein sequence in terms of a “ΔΔG”: the change in free energy of a protein upon mutation. This formalism has been especially useful in many applications, such as identifying stabilizing mutations for industrial protein engineering applications, or identifying “hot spot” residues in protein-protein interaction interfaces that contribute most of the energy to binding.</p>
<p>Computing changes of free energy is at the core of the design functionality in Rosetta, since we undergo a design simulation by choosing mutations (sampling) and seeing whether they improve the predicted energy of the structure (scoring). In this exercise, we will see how close we can get with predicting the ΔΔG of mutations in a well-studied monomeric protein, lysozyme. We will try to compute a ΔΔG in a couple of ways, and at each step compare the predictions with the experimentally measured ΔΔG.</p>
<p>The files for this exercise are found at <a class="reference external" href="https://github.com/Kortemme-Lab/protein_design_course_files/ddg_exercise">https://github.com/Kortemme-Lab/protein_design_course_files/ddg_exercise</a></p>
<p>If you have already git installed this repository, please update it with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">protein_design_course_files</span>
<span class="n">git</span> <span class="n">pull</span>
<span class="n">cd</span> <span class="n">ddg_exercise</span>
</pre></div>
</div>
<p>If you need to install the repository for the first time, run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">Kortemme</span><span class="o">-</span><span class="n">Lab</span><span class="o">/</span><span class="n">protein_design_course_files</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">protein_design_course_files</span>
<span class="n">cd</span> <span class="n">ddg_exercise</span>
</pre></div>
</div>
<p>Remember to initialize your conda environment with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">proteindesign</span>
</pre></div>
</div>
<p>For this exercise, you can open the jupyter notebook to run the code by typing <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebook</span></code>, or you can copy-paste each chunk into a python console, which you initiate by typing <code class="docutils literal notranslate"><span class="pre">python</span></code> or <code class="docutils literal notranslate"><span class="pre">ipython</span></code>.</p>
<p>As always, we start by initializing our PyRosetta session with an <code class="docutils literal notranslate"><span class="pre">init</span></code> call.</p>
<div class="cell tag_remove_output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">pyrosetta</span>
<span class="kn">from</span> <span class="nn">pyrosetta</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">pyrosetta</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">               -ex1</span>
<span class="s1">               -ex2</span>
<span class="s1">               -score:weights ref2015_cart</span>
<span class="s1">               -use_input_sc</span>
<span class="s1">               -ignore_unrecognized_res           </span>
<span class="s1">               &#39;&#39;&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyrosetta.rosetta.core.pack.task</span> <span class="kn">import</span> <span class="n">TaskFactory</span>
<span class="kn">from</span> <span class="nn">pyrosetta.rosetta.core.pack.task</span> <span class="kn">import</span> <span class="n">operation</span>
<span class="kn">from</span> <span class="nn">pyrosetta.rosetta.core.select</span> <span class="kn">import</span> <span class="n">residue_selector</span>

<span class="n">scorefxn</span> <span class="o">=</span> <span class="n">create_score_function</span><span class="p">(</span><span class="s1">&#39;ref2015_cart&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s also load in the experimentally measured ΔΔG’s so we have them for comparison to our calculated ΔΔG’s. We will use a dataset derived from the public ProTherm database (<a class="reference external" href="https://www.iitm.ac.in/bioinfo/ProTherm/">https://www.iitm.ac.in/bioinfo/ProTherm/</a>). This dataset was curated to include high-quality measurements for use in benchmarking computational ΔΔG protocols (described at <a class="reference external" href="https://doi.org/10.1371/journal.pone.0130433">https://doi.org/10.1371/journal.pone.0130433</a>).</p>
<p>If you’re curious about the types of studies that generate this data, here’s a good example: <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/1911773/">https://pubmed.ncbi.nlm.nih.gov/1911773/</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1"># function to convert &#39;A G 44 S&#39; format (chain aa_from position aa_to) to G44S</span>
<span class="c1"># for curated_protherm datasets</span>
<span class="k">def</span> <span class="nf">convert_mutation_format</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39; |_&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span>

<span class="c1"># read only the lysozyme mutants (PDB 1L63) from the protherm dataset</span>
<span class="n">pt</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;~/lab/gsp1_ddg/benchmarking/datasets/curatedprotherm.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">PDBFileID</span> <span class="o">==</span> <span class="s1">&#39;1L63&#39;</span><span class="p">]</span>
      <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">DSSPSimpleTypes</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># ignore records w/ &gt;1 mutation</span>
      <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">chain</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">Mutations</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
              <span class="n">mutation_short</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">Mutations</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">convert_mutation_format</span><span class="p">(</span><span class="n">row</span><span class="p">)),</span>
              <span class="n">position</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">mutation_short</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span>
              <span class="n">aa_to</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">mutation_short</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
              <span class="p">)</span>
      <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;RecordID&#39;</span><span class="p">:</span><span class="s1">&#39;protherm_ID&#39;</span><span class="p">,</span><span class="s1">&#39;PDBFileID&#39;</span><span class="p">:</span><span class="s1">&#39;pdb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mutations&#39;</span><span class="p">:</span><span class="s1">&#39;mutation&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;DDG&#39;</span><span class="p">:</span><span class="s1">&#39;ddg_expt&#39;</span><span class="p">,</span> <span class="s1">&#39;IndividualDDGs&#39;</span><span class="p">:</span><span class="s1">&#39;ddg_expt_individ&#39;</span><span class="p">})</span>
      <span class="p">[[</span><span class="s1">&#39;pdb&#39;</span><span class="p">,</span><span class="s1">&#39;mutation&#39;</span><span class="p">,</span><span class="s1">&#39;chain&#39;</span><span class="p">,</span><span class="s1">&#39;mutation_short&#39;</span><span class="p">,</span><span class="s1">&#39;position&#39;</span><span class="p">,</span><span class="s1">&#39;protherm_ID&#39;</span><span class="p">,</span><span class="s1">&#39;ddg_expt&#39;</span><span class="p">,</span><span class="s1">&#39;ddg_expt_individ&#39;</span><span class="p">]]</span>
<span class="p">)</span>

<span class="n">pt</span><span class="p">[(</span><span class="n">pt</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="mi">99</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">pdb</span> <span class="o">==</span> <span class="s1">&#39;1L63&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pdb</th>
      <th>mutation</th>
      <th>chain</th>
      <th>mutation_short</th>
      <th>position</th>
      <th>protherm_ID</th>
      <th>ddg_expt</th>
      <th>ddg_expt_individ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1037</th>
      <td>1L63</td>
      <td>A L 99 A</td>
      <td>A</td>
      <td>L99A</td>
      <td>99</td>
      <td>814</td>
      <td>4.533333</td>
      <td>5.0_5.0_4.5_4.6_4.0_4.1</td>
    </tr>
    <tr>
      <th>1038</th>
      <td>1L63</td>
      <td>A L 99 F</td>
      <td>A</td>
      <td>L99F</td>
      <td>99</td>
      <td>903</td>
      <td>0.330000</td>
      <td>0.36_0.3</td>
    </tr>
    <tr>
      <th>1039</th>
      <td>1L63</td>
      <td>A L 99 G</td>
      <td>A</td>
      <td>L99G</td>
      <td>99</td>
      <td>866</td>
      <td>6.850000</td>
      <td>7.4_6.3</td>
    </tr>
    <tr>
      <th>1040</th>
      <td>1L63</td>
      <td>A L 99 I</td>
      <td>A</td>
      <td>L99I</td>
      <td>99</td>
      <td>884</td>
      <td>1.450000</td>
      <td>1.4_1.5</td>
    </tr>
    <tr>
      <th>1041</th>
      <td>1L63</td>
      <td>A L 99 M</td>
      <td>A</td>
      <td>L99M</td>
      <td>99</td>
      <td>914</td>
      <td>0.583333</td>
      <td>0.4_0.75_0.6</td>
    </tr>
    <tr>
      <th>1042</th>
      <td>1L63</td>
      <td>A L 99 V</td>
      <td>A</td>
      <td>L99V</td>
      <td>99</td>
      <td>863</td>
      <td>2.135000</td>
      <td>2.27_2.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>I’ve pre-relaxed the starting crystal structure for you to save some time. If you’d like to run Relax yourself, feel free to run the script in the directory with the command below. It should take about 10 minutes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">relax_1L63</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Next, load in our PDBs</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pose</span> <span class="o">=</span> <span class="n">pose_from_pdb</span><span class="p">(</span><span class="s1">&#39;1l63_clean.pdb&#39;</span><span class="p">)</span>
<span class="n">pose</span><span class="o">.</span><span class="n">pdb_info</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s1">&#39;1l63_xtal&#39;</span><span class="p">)</span>
<span class="n">pose_relaxed</span> <span class="o">=</span> <span class="n">pose_from_pdb</span><span class="p">(</span><span class="s1">&#39;1l63_relaxed.pdb&#39;</span><span class="p">)</span>
<span class="n">pose_relaxed</span><span class="o">.</span><span class="n">pdb_info</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s1">&#39;1l63_relaxed&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>core.import_pose.import_pose: File &#39;1l63_clean.pdb&#39; automatically determined to be of type PDB
core.conformation.Conformation: <span class=" -Color -Color-Bold">[ WARNING ]</span> missing heavyatom:  OXT on residue LYS:CtermProteinFull 162
core.import_pose.import_pose: File &#39;1l63_relaxed.pdb&#39; automatically determined to be of type PDB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmm</span> <span class="o">=</span> <span class="n">PyMOLMover</span><span class="p">()</span>
<span class="n">pmm</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pose_relaxed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In PyMOL, copy and paste the following commands to show the core packing around Leu 99.</p>
<p><code class="docutils literal notranslate"><span class="pre">util.cbaw</span> <span class="pre">1l63_relaxed</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">select</span> <span class="pre">core,</span> <span class="pre">1l63_relaxed</span> <span class="pre">and</span> <span class="pre">br.</span> <span class="pre">(sc.</span>&#160; <span class="pre">within</span> <span class="pre">3</span> <span class="pre">of</span> <span class="pre">(resi</span> <span class="pre">99</span> <span class="pre">and</span> <span class="pre">sc.))</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">util.cbac</span> <span class="pre">core</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">util.cbas</span> <span class="pre">core</span> <span class="pre">and</span> <span class="pre">resi</span> <span class="pre">99</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">spheres,</span> <span class="pre">core</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">set_view</span> <span class="pre">(\</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">0.749474406,</span>&#160;&#160; <span class="pre">-0.659760594,</span>&#160;&#160; <span class="pre">-0.054414708,\</span>&#160;&#160;&#160;&#160; <span class="pre">-0.335082650,</span>&#160;&#160; <span class="pre">-0.448958933,</span>&#160;&#160;&#160; <span class="pre">0.828328848,\</span>&#160;&#160;&#160;&#160; <span class="pre">-0.570924938,</span>&#160;&#160; <span class="pre">-0.602581918,</span>&#160;&#160; <span class="pre">-0.557566702,\</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">0.000094488,</span>&#160;&#160;&#160; <span class="pre">0.001106668,</span>&#160; <span class="pre">-85.698837280,\</span>&#160;&#160;&#160;&#160; <span class="pre">30.798748016,</span>&#160;&#160;&#160; <span class="pre">4.481562614,</span>&#160;&#160;&#160; <span class="pre">6.916054726,\</span>&#160;&#160;&#160;&#160; <span class="pre">49.036270142,</span>&#160; <span class="pre">122.386810303,</span>&#160; <span class="pre">-20.000000000</span> <span class="pre">)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">deselect</span></code></p>
<p>You should see Leu 99 in pink in the center of the frame, well packed in the core of the protein.</p>
<p>Now run the following commands to show sidechains as sticks instead of as spheres:</p>
<p><code class="docutils literal notranslate"><span class="pre">hide</span> <span class="pre">spheres,</span> <span class="pre">core</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">sticks,</span> <span class="pre">core</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">hydro</span></code></p>
<p>It should now be much easier to see how each of the sidechains in the residues shown are pointed inward to form the hydrophobic core of the protein.</p>
<p>Next, we are going to compute the change in energy for when we mutating Leu 99 to a Phenylalanine, which has a large benzene ring as a sidechain. This mutant can be referred to as L99F.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pose_L99F</span> <span class="o">=</span> <span class="n">pose_relaxed</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="n">pose_L99F</span><span class="o">.</span><span class="n">pdb_info</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s1">&#39;L99F&#39;</span><span class="p">)</span>

<span class="n">mutate_mover</span> <span class="o">=</span> <span class="n">pyrosetta</span><span class="o">.</span><span class="n">rosetta</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">simple_moves</span><span class="o">.</span><span class="n">MutateResidue</span><span class="p">()</span>
<span class="n">mutate_mover</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="n">mutate_mover</span><span class="o">.</span><span class="n">set_res_name</span><span class="p">(</span><span class="s1">&#39;PHE&#39;</span><span class="p">)</span>
<span class="n">mutate_mover</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pose_L99F</span><span class="p">)</span>

<span class="c1"># score WT and L99F mutant</span>
<span class="n">WT_score</span> <span class="o">=</span> <span class="n">scorefxn</span><span class="p">(</span><span class="n">pose_relaxed</span><span class="p">)</span>
<span class="n">L99F_score</span> <span class="o">=</span> <span class="n">scorefxn</span><span class="p">(</span><span class="n">pose_L99F</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">WT score: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">WT_score</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">L99F score: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">L99F_score</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>core.scoring.CartesianBondedEnergy: Creating new peptide-bonded energy container (162)
basic.io.database: Database file opened: scoring/score_functions/elec_cp_reps.dat
core.scoring.elec.util: Read 40 countpair representative atoms
core.pack.dunbrack.RotamerLibrary: shapovalov_lib_fixes_enable option is true.
core.pack.dunbrack.RotamerLibrary: shapovalov_lib::shap_dun10_smooth_level of 1( aka lowest_smooth ) got activated.
core.pack.dunbrack.RotamerLibrary: Binary rotamer library selected: /Users/cjmathy/.pyenv/versions/3.8.4/lib/python3.8/site-packages/pyrosetta-2020.28+release.8ecab77aa50-py3.8-macosx-10.15-x86_64.egg/pyrosetta/database/rotamer/shapovalov/StpDwn_0-0-0/Dunbrack10.lib.bin
core.pack.dunbrack.RotamerLibrary: Using Dunbrack library binary file &#39;/Users/cjmathy/.pyenv/versions/3.8.4/lib/python3.8/site-packages/pyrosetta-2020.28+release.8ecab77aa50-py3.8-macosx-10.15-x86_64.egg/pyrosetta/database/rotamer/shapovalov/StpDwn_0-0-0/Dunbrack10.lib.bin&#39;.
core.pack.dunbrack.RotamerLibrary: Dunbrack 2010 library took 0.230011 seconds to load from binary
core.scoring.CartesianBondedEnergy: Creating new peptide-bonded energy container (162)

WT score: -594.2379820591656

L99F score: -231.520224208531
</pre></div>
</div>
</div>
</div>
<p>The score has jumped quite a bit! If we quantify by how much it has changed, we get the ΔΔG. That is, The ΔΔG of a mutation is defined as the difference in free energy of protein before and after mutation, or <span class="math notranslate nohighlight">\(ΔΔG_{MUTATION} = ΔG_{MUT} - ΔG_{\text{WT}}\)</span></p>
<p>Since the Rosetta score function is meant to approximate energies, we can use it to compute a predicted ΔΔG of L99F. Note that the score is given in REU energy units. For this specific score function and application, assume that 1 REU is about 3-4 kcal/mol, so we will divide our difference in scores by 4. We then compare our computed ΔΔG to the measured ΔΔG from the ProTherm database.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaling_factor_for_ddG</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">ddG_L99F</span> <span class="o">=</span> <span class="n">L99F_score</span> <span class="o">-</span> <span class="n">WT_score</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Difference in score L99F - WT: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ddG_L99F</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computed ΔΔG of L99F: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ddG_L99F</span><span class="o">/</span><span class="n">scaling_factor_for_ddG</span><span class="p">))</span>

<span class="n">L99F_ddG_measured</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="n">pt</span><span class="o">.</span><span class="n">mutation</span> <span class="o">==</span> <span class="s1">&#39;A L 99 F&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ddg_expt</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Measured ΔΔG of L99F: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">L99F_ddG_measured</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Difference in score L99F - WT: 362.7177578506346
Computed ΔΔG of L99F: 90.67943946265865
Measured ΔΔG of L99F: 0.33
</pre></div>
</div>
</div>
</div>
<p>Unfortunately, we are off by two orders of magnitude. In fact, the experimental ΔΔG tells us that L99F is not a destabilizing mutation. First, let’s examine why Rosetta thinks it should be destabilizing by looking at which energy terms changed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">energy_table_WT</span> <span class="o">=</span> <span class="n">pyrosetta</span><span class="o">.</span><span class="n">bindings</span><span class="o">.</span><span class="n">energies</span><span class="o">.</span><span class="n">residue_total_energies_array</span><span class="p">(</span><span class="n">pose_relaxed</span><span class="o">.</span><span class="n">energies</span><span class="p">())</span>
<span class="n">energy_df_WT</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">energy_table_WT</span><span class="p">)</span>
<span class="n">totals_by_term_WT</span> <span class="o">=</span> <span class="n">energy_df_WT</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="n">energy_table_L99F</span> <span class="o">=</span> <span class="n">pyrosetta</span><span class="o">.</span><span class="n">bindings</span><span class="o">.</span><span class="n">energies</span><span class="o">.</span><span class="n">residue_total_energies_array</span><span class="p">(</span><span class="n">pose_L99F</span><span class="o">.</span><span class="n">energies</span><span class="p">())</span>
<span class="n">energy_df_L99F</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">energy_table_L99F</span><span class="p">)</span>
<span class="n">totals_by_term_L99F</span> <span class="o">=</span> <span class="n">energy_df_L99F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">totals_by_term_L99F</span> <span class="o">-</span> <span class="n">totals_by_term_WT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fa_atr                  -4.568252
fa_rep                 667.622239
fa_sol                  -0.383533
fa_intra_rep            -0.220956
fa_intra_sol_xover4      0.114745
lk_ball_wtd             -0.169003
fa_elec                 -0.639650
hbond_sr_bb              0.000000
hbond_lr_bb              0.000000
hbond_bb_sc              0.000000
hbond_sc                 0.000000
dslf_fa13                0.000000
omega                    0.000000
fa_dun                   1.912687
p_aa_pp                  0.404242
yhh_planarity            0.000000
ref                     -0.443180
rama_prepro              0.197129
cart_bonded             -0.389653
total_score            362.577561
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The energy term <code class="docutils literal notranslate"><span class="pre">fa_rep</span></code> showed a massive jump. This suggests that there are clashes in the structure, where atoms are too close to each other. This is what we expected, because we introduced a larger Phenylalanine side chain into the space previously occupied by the smaller Leucine, and the fit was already tight. We can visualize this in the structure. First send the mutated pose to PyMOL, then run the commands below it to visualize just the mutated pose.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmm</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pose_L99F</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In PyMOL, copy and paste the following commands to visualize the clashes around the Phenylalanine introduced by the L99F mutation.</p>
<p><code class="docutils literal notranslate"><span class="pre">util.cbaw</span> <span class="pre">L99F</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">select</span> <span class="pre">L99F_core,</span> <span class="pre">L99F</span> <span class="pre">and</span> <span class="pre">br.</span> <span class="pre">(sc.</span>&#160; <span class="pre">within</span> <span class="pre">3</span> <span class="pre">of</span> <span class="pre">(resi</span> <span class="pre">99</span> <span class="pre">and</span> <span class="pre">sc.))</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">util.cbac</span> <span class="pre">L99F_core</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">util.cbas</span> <span class="pre">L99F_core</span> <span class="pre">and</span> <span class="pre">resi</span> <span class="pre">99</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">sticks,</span> <span class="pre">L99F_core</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">hydro</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">spheres,</span> <span class="pre">L99F</span> <span class="pre">and</span> <span class="pre">(resi</span> <span class="pre">84</span> <span class="pre">or</span> <span class="pre">resi</span> <span class="pre">99)</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">(name</span> <span class="pre">O</span> <span class="pre">or</span> <span class="pre">name</span> <span class="pre">N)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">set_view</span> <span class="pre">(\</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">0.969336450,</span>&#160;&#160; <span class="pre">-0.243796781,</span>&#160;&#160; <span class="pre">-0.030075530,\</span>&#160;&#160;&#160;&#160; <span class="pre">-0.183128297,</span>&#160;&#160; <span class="pre">-0.798800588,</span>&#160;&#160;&#160; <span class="pre">0.573020101,\</span>&#160;&#160;&#160;&#160; <span class="pre">-0.163719043,</span>&#160;&#160; <span class="pre">-0.549941719,</span>&#160;&#160; <span class="pre">-0.818962932,\</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">0.000094488,</span>&#160;&#160;&#160; <span class="pre">0.001106668,</span>&#160; <span class="pre">-68.288848877,\</span>&#160;&#160;&#160;&#160; <span class="pre">30.798748016,</span>&#160;&#160;&#160; <span class="pre">4.481562614,</span>&#160;&#160;&#160; <span class="pre">6.916054726,\</span>&#160;&#160;&#160;&#160; <span class="pre">31.626289368,</span>&#160; <span class="pre">104.976821899,</span>&#160; <span class="pre">-20.000000000</span> <span class="pre">)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">deselect</span></code></p>
<p>The pink Phenylalanine at position 99 is shoved into the space filled by Leucine 84! This is not an even remotely likely arrangement of atoms in nature, and Rosetta accordingly scores it very badly. So what have we done wrong when mutating L99F?</p>
<p>The small experimental ΔΔG tells us that the native state of the L99F mutant has a very similar (within 1 kcal/mol) energy to the wild type protein, which suggests that the sidechains that were densely packed around Leu 99 could in fact shift to accommodate a larger Phenylalanine. However, we did not instruct Rosetta to repack around the mutation. Repacking is the process of sampling different rotamers (side chain conformations) for the residues in contact with residue 99.</p>
<p>Let’s repack any residues within 10 Angstroms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select mutant position</span>
<span class="n">mutant_position</span> <span class="o">=</span> <span class="n">residue_selector</span><span class="o">.</span><span class="n">ResidueIndexSelector</span><span class="p">()</span>
<span class="n">mutant_position</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>

<span class="c1"># Select neighbor positions</span>
<span class="n">nbr_selector</span> <span class="o">=</span> <span class="n">residue_selector</span><span class="o">.</span><span class="n">NeighborhoodResidueSelector</span><span class="p">()</span> 
<span class="n">nbr_selector</span><span class="o">.</span><span class="n">set_focus_selector</span><span class="p">(</span><span class="n">mutant_position</span><span class="p">)</span>
<span class="n">nbr_selector</span><span class="o">.</span><span class="n">set_include_focus_in_subset</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">nbr_selector</span><span class="o">.</span><span class="n">set_distance</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># note default is 10, so could leave this out</span>

<span class="c1"># Make a task factory</span>
<span class="n">tf</span> <span class="o">=</span> <span class="n">TaskFactory</span><span class="p">()</span>
<span class="n">tf</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">operation</span><span class="o">.</span><span class="n">InitializeFromCommandline</span><span class="p">())</span>
<span class="n">tf</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">operation</span><span class="o">.</span><span class="n">IncludeCurrent</span><span class="p">())</span>
<span class="n">tf</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">operation</span><span class="o">.</span><span class="n">NoRepackDisulfides</span><span class="p">())</span>

<span class="c1"># Disable packing for all residues, then re-enable it for neigbor residues</span>
<span class="n">prevent_repacking_rlt</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">PreventRepackingRLT</span><span class="p">()</span>
<span class="n">define_repacking</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">OperateOnResidueSubset</span><span class="p">(</span><span class="n">prevent_repacking_rlt</span><span class="p">,</span> <span class="n">nbr_selector</span><span class="p">,</span> <span class="kc">True</span> <span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">define_repacking</span><span class="p">)</span>

<span class="c1"># Disable design for the whole protein, since we only want to repack</span>
<span class="n">not_design</span> <span class="o">=</span> <span class="n">residue_selector</span><span class="o">.</span><span class="n">TrueResidueSelector</span><span class="p">()</span>
<span class="n">tf</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">operation</span><span class="o">.</span><span class="n">OperateOnResidueSubset</span><span class="p">(</span><span class="n">operation</span><span class="o">.</span><span class="n">RestrictToRepackingRLT</span><span class="p">(),</span><span class="n">not_design</span><span class="p">))</span>

<span class="c1"># Uncomment this command to see whether you set up the packer correctly</span>
<span class="c1"># print(tf.create_task_and_apply_taskoperations(pose_L99F))  </span>

<span class="c1"># # Create Packer</span>
<span class="n">packer</span> <span class="o">=</span> <span class="n">pyrosetta</span><span class="o">.</span><span class="n">rosetta</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">minimization_packing</span><span class="o">.</span><span class="n">PackRotamersMover</span><span class="p">()</span>
<span class="n">packer</span><span class="o">.</span><span class="n">task_factory</span><span class="p">(</span><span class="n">tf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run repacking</span>
<span class="n">pose_L99F_repacked</span> <span class="o">=</span> <span class="n">pose_L99F</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="n">pose_L99F_repacked</span><span class="o">.</span><span class="n">pdb_info</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s1">&#39;L99F_repacked&#39;</span><span class="p">)</span>

<span class="n">packer</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pose_L99F_repacked</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>protocols.minimization_packing.PackRotamersMover: <span class=" -Color -Color-Bold">[ WARNING ]</span> undefined ScoreFunction -- creating a default one
core.scoring.ScoreFunctionFactory: SCOREFUNCTION: <span class=" -Color -Color-Green">ref2015_cart</span>
core.pack.task: Packer task: initialize from command line()
core.pack.pack_rotamers: built 777 rotamers at 26 positions.
core.pack.interaction_graph.interaction_graph_factory: Instantiating DensePDInteractionGraph
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L99F_repacked_score</span> <span class="o">=</span> <span class="n">scorefxn</span><span class="p">(</span><span class="n">pose_L99F_repacked</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">WT score: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">WT_score</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">L99F mutated score: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">L99F_score</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">L99F repacked score: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">L99F_repacked_score</span><span class="p">))</span>

<span class="n">ddG_L99F</span> <span class="o">=</span> <span class="n">L99F_repacked_score</span> <span class="o">-</span> <span class="n">WT_score</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">Difference in score L99F (repacked) - WT: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ddG_L99F</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computed ΔΔG of L99F: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ddG_L99F</span><span class="o">/</span><span class="n">scaling_factor_for_ddG</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Measured ΔΔG of L99F: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">L99F_ddG_measured</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WT score: -594.2379820591656

L99F mutated score: -231.520224208531

L99F repacked score: -312.30548187189106


Difference in score L99F (repacked) - WT: 281.9325001872745
Computed ΔΔG of L99F: 70.48312504681863
Measured ΔΔG of L99F: 0.33
</pre></div>
</div>
</div>
</div>
<p>This is much better! but still off two an orders of magnitude. If we examine the structure, we see that just repacking was not enough to resolve the clash</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmm</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pose_L99F_repacked</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">util.cbaw</span> <span class="pre">L99F_repacked</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">select</span> <span class="pre">L99F_repacked_core,</span> <span class="pre">L99F_repacked</span> <span class="pre">and</span> <span class="pre">br.</span> <span class="pre">(sc.</span>&#160; <span class="pre">within</span> <span class="pre">3</span> <span class="pre">of</span> <span class="pre">(resi</span> <span class="pre">99</span> <span class="pre">and</span> <span class="pre">sc.))</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">util.cbac</span> <span class="pre">L99F_repacked_core</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">util.cbas</span> <span class="pre">L99F_repacked_core</span> <span class="pre">and</span> <span class="pre">resi</span> <span class="pre">99</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">sticks,</span> <span class="pre">L99F_repacked_core</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">hydro</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">show</span> <span class="pre">spheres,</span> <span class="pre">L99F_repacked_core</span> <span class="pre">and</span> <span class="pre">(resi</span> <span class="pre">84</span> <span class="pre">or</span> <span class="pre">resi</span> <span class="pre">99)</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">(name</span> <span class="pre">O</span> <span class="pre">or</span> <span class="pre">name</span> <span class="pre">N)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">set_view</span> <span class="pre">(\</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">0.737348735,</span>&#160;&#160; <span class="pre">-0.664588213,</span>&#160;&#160; <span class="pre">-0.120811388,\</span>&#160;&#160;&#160;&#160; <span class="pre">-0.212751448,</span>&#160;&#160; <span class="pre">-0.398235619,</span>&#160;&#160;&#160; <span class="pre">0.892252982,\</span>&#160;&#160;&#160;&#160; <span class="pre">-0.641090214,</span>&#160;&#160; <span class="pre">-0.632204175,</span>&#160;&#160; <span class="pre">-0.435039639,\</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">0.000094488,</span>&#160;&#160;&#160; <span class="pre">0.001106668,</span>&#160; <span class="pre">-85.698837280,\</span>&#160;&#160;&#160;&#160; <span class="pre">30.798748016,</span>&#160;&#160;&#160; <span class="pre">4.481562614,</span>&#160;&#160;&#160; <span class="pre">6.916054726,\</span>&#160;&#160;&#160;&#160; <span class="pre">49.036270142,</span>&#160; <span class="pre">122.386810303,</span>&#160; <span class="pre">-20.000000000</span> <span class="pre">)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">deselect</span></code></p>
<p>This suggests that the backbone as it currently is modeled is just not capable of incorporating the large phenyl group. We must therefore introduce changes to the backbone to see if we can create some space. We can do this by adding a minimization step to our repacking. At this point, we are just running a round of relax while restricting repacking to the vicinity around the mutation.</p>
<div class="cell tag_output-scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create movemap factory</span>
<span class="n">mmf</span> <span class="o">=</span> <span class="n">pyrosetta</span><span class="o">.</span><span class="n">rosetta</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">select</span><span class="o">.</span><span class="n">movemap</span><span class="o">.</span><span class="n">MoveMapFactory</span><span class="p">()</span>
<span class="n">mmf</span><span class="o">.</span><span class="n">all_bb</span><span class="p">(</span><span class="n">setting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mmf</span><span class="o">.</span><span class="n">all_bondangles</span><span class="p">(</span><span class="n">setting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mmf</span><span class="o">.</span><span class="n">all_bondlengths</span><span class="p">(</span><span class="n">setting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mmf</span><span class="o">.</span><span class="n">all_chi</span><span class="p">(</span><span class="n">setting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mmf</span><span class="o">.</span><span class="n">all_jumps</span><span class="p">(</span><span class="n">setting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mmf</span><span class="o">.</span><span class="n">set_cartesian</span><span class="p">(</span><span class="n">setting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Make fastrelax protocol</span>
<span class="n">fr</span> <span class="o">=</span> <span class="n">pyrosetta</span><span class="o">.</span><span class="n">rosetta</span><span class="o">.</span><span class="n">protocols</span><span class="o">.</span><span class="n">relax</span><span class="o">.</span><span class="n">FastRelax</span><span class="p">(</span><span class="n">standard_repeats</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fr</span><span class="o">.</span><span class="n">set_scorefxn</span><span class="p">(</span><span class="n">scorefxn</span><span class="p">)</span>
<span class="n">fr</span><span class="o">.</span><span class="n">set_task_factory</span><span class="p">(</span><span class="n">tf</span><span class="p">)</span>
<span class="n">fr</span><span class="o">.</span><span class="n">set_movemap_factory</span><span class="p">(</span><span class="n">mmf</span><span class="p">)</span>
<span class="n">fr</span><span class="o">.</span><span class="n">cartesian</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fr</span><span class="o">.</span><span class="n">min_type</span><span class="p">(</span><span class="s2">&quot;lbfgs_armijo_nonmonotone&quot;</span><span class="p">)</span>

<span class="n">pose_L99F_relaxed</span> <span class="o">=</span> <span class="n">pose_L99F</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<span class="n">pose_L99F_relaxed</span><span class="o">.</span><span class="n">pdb_info</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="s1">&#39;L99F_relaxed&#39;</span><span class="p">)</span>

<span class="n">fr</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pose_L99F_relaxed</span><span class="p">)</span>

<span class="n">pose_L99F_relaxed</span><span class="o">.</span><span class="n">dump_pdb</span><span class="p">(</span><span class="s1">&#39;1l63_L99F_relaxed.pdb&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>protocols.relax.RelaxScriptManager: Reading relax scripts list from database.
core.scoring.ScoreFunctionFactory: SCOREFUNCTION: <span class=" -Color -Color-Green">ref2015_cart</span>
protocols.relax.RelaxScriptManager: Looking for MonomerRelax2019.txt
protocols.relax.RelaxScriptManager: ================== Reading script file: /Users/cjmathy/.pyenv/versions/3.8.4/lib/python3.8/site-packages/pyrosetta-2020.28+release.8ecab77aa50-py3.8-macosx-10.15-x86_64.egg/pyrosetta/database/sampling/relax_scripts/MonomerRelax2019.txt ==================
protocols.relax.RelaxScriptManager: repeat %%nrepeats%%
protocols.relax.RelaxScriptManager: coord_cst_weight 1.0
protocols.relax.RelaxScriptManager: scale:fa_rep 0.040
protocols.relax.RelaxScriptManager: repack
protocols.relax.RelaxScriptManager: scale:fa_rep 0.051
protocols.relax.RelaxScriptManager: min 0.01
protocols.relax.RelaxScriptManager: coord_cst_weight 0.5
protocols.relax.RelaxScriptManager: scale:fa_rep 0.265
protocols.relax.RelaxScriptManager: repack
protocols.relax.RelaxScriptManager: scale:fa_rep 0.280
protocols.relax.RelaxScriptManager: min 0.01
protocols.relax.RelaxScriptManager: coord_cst_weight 0.0
protocols.relax.RelaxScriptManager: scale:fa_rep 0.559
protocols.relax.RelaxScriptManager: repack
protocols.relax.RelaxScriptManager: scale:fa_rep 0.581
protocols.relax.RelaxScriptManager: min 0.01
protocols.relax.RelaxScriptManager: coord_cst_weight 0.0
protocols.relax.RelaxScriptManager: scale:fa_rep 1
protocols.relax.RelaxScriptManager: repack
protocols.relax.RelaxScriptManager: min 0.00001
protocols.relax.RelaxScriptManager: accept_to_best
protocols.relax.RelaxScriptManager: endrepeat
protocols.relax.FastRelax: CMD: repeat  -231.52  0  0  0.55
protocols.relax.FastRelax: CMD: coord_cst_weight  -231.52  0  0  0.55
protocols.relax.FastRelax: CMD: scale:fa_rep  -689.823  0  0  0.022
core.pack.task: Packer task: initialize from command line()
core.pack.pack_rotamers: built 1433 rotamers at 26 positions.
core.pack.interaction_graph.interaction_graph_factory: Instantiating DensePDInteractionGraph
protocols.relax.FastRelax: CMD: repack  -696.498  0  0  0.022
protocols.relax.FastRelax: CMD: scale:fa_rep  -692.071  0  0  0.02805
protocols.relax.FastRelax: CMD: min  -872.487  0.918798  0.918798  0.02805
protocols.relax.FastRelax: CMD: coord_cst_weight  -872.487  0.918798  0.918798  0.02805
protocols.relax.FastRelax: CMD: scale:fa_rep  -498.587  0.918798  0.918798  0.14575
core.pack.task: Packer task: initialize from command line()
core.pack.pack_rotamers: built 1146 rotamers at 36 positions.
core.pack.interaction_graph.interaction_graph_factory: Instantiating DensePDInteractionGraph
protocols.relax.FastRelax: CMD: repack  -500.022  0.918798  0.918798  0.14575
protocols.relax.FastRelax: CMD: scale:fa_rep  -474.206  0.918798  0.918798  0.154
protocols.relax.FastRelax: CMD: min  -719.215  0.442488  0.442488  0.154
protocols.relax.FastRelax: CMD: coord_cst_weight  -719.215  0.442488  0.442488  0.154
protocols.relax.FastRelax: CMD: scale:fa_rep  -625.088  0.442488  0.442488  0.30745
core.pack.task: Packer task: initialize from command line()
core.pack.pack_rotamers: built 1028 rotamers at 31 positions.
core.pack.interaction_graph.interaction_graph_factory: Instantiating DensePDInteractionGraph
protocols.relax.FastRelax: CMD: repack  -625.088  0.442488  0.442488  0.30745
protocols.relax.FastRelax: CMD: scale:fa_rep  -617.665  0.442488  0.442488  0.31955
protocols.relax.FastRelax: CMD: min  -647.823  0.285895  0.285895  0.31955
protocols.relax.FastRelax: CMD: coord_cst_weight  -647.823  0.285895  0.285895  0.31955
protocols.relax.FastRelax: CMD: scale:fa_rep  -573.818  0.285895  0.285895  0.55
core.pack.task: Packer task: initialize from command line()
core.pack.pack_rotamers: built 899 rotamers at 29 positions.
core.pack.interaction_graph.interaction_graph_factory: Instantiating DensePDInteractionGraph
protocols.relax.FastRelax: CMD: repack  -573.818  0.285895  0.285895  0.55
protocols.relax.FastRelax: CMD: min  -590.075  0.246572  0.246572  0.55
protocols.relax.FastRelax: MRP: 0  -590.075  -590.075  0.246572  0.246572
protocols.relax.FastRelax: CMD: accept_to_best  -590.075  0.246572  0.246572  0.55
protocols.relax.FastRelax: CMD: endrepeat  -590.075  0.246572  0.246572  0.55
protocols::checkpoint: Deleting checkpoints of FastRelax
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L99F_relaxed_score</span> <span class="o">=</span> <span class="n">scorefxn</span><span class="p">(</span><span class="n">pose_L99F_relaxed</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">WT score: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">WT_score</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">L99F mutated score: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">L99F_score</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">L99F repacked score: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">L99F_score</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">L99F relaxed score: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">L99F_relaxed_score</span><span class="p">))</span>

<span class="n">ddG_L99F</span> <span class="o">=</span> <span class="n">L99F_relaxed_score</span> <span class="o">-</span> <span class="n">WT_score</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">Difference in score L99F (relaxed) - WT: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ddG_L99F</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computed ΔΔG of L99F: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ddG_L99F</span><span class="o">/</span><span class="n">scaling_factor_for_ddG</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Measured ΔΔG of L99F: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">L99F_ddG_measured</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WT score: -594.2379820591656

L99F mutated score: -231.520224208531

L99F repacked score: -231.520224208531

L99F relaxed score: -590.075165842423


Difference in score L99F (relaxed) - WT: 4.162816216742613
Computed ΔΔG of L99F: 1.0407040541856531
Measured ΔΔG of L99F: 0.33
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmm</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pose_L99F_relaxed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This is much better! We may be able to get even closer to the “true” native state of L99F with additional and or longer rounds of relax, as the increased sampling of backbones may find one even better suited for the mutation. However, we were using a rough scaling factor anyway, so let’s not worry about it. Let’s look at our new structure.</p>
<p><code class="docutils literal notranslate"><span class="pre">util.cbaw</span> <span class="pre">L99F_relaxed</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">select</span> <span class="pre">L99F_relaxed_core,</span> <span class="pre">L99F_relaxed</span> <span class="pre">and</span> <span class="pre">br.</span> <span class="pre">(sc.</span>&#160; <span class="pre">within</span> <span class="pre">3</span> <span class="pre">of</span> <span class="pre">(resi</span> <span class="pre">99</span> <span class="pre">and</span> <span class="pre">sc.))</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">util.cbac</span> <span class="pre">L99F_relaxed_core</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">util.cbas</span> <span class="pre">L99F_relaxed_core</span> <span class="pre">and</span> <span class="pre">resi</span> <span class="pre">99</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">sticks,</span> <span class="pre">L99F_relaxed_core</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">hydro</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">show</span> <span class="pre">spheres,</span> <span class="pre">L99F_relaxed_core</span> <span class="pre">and</span> <span class="pre">(resi</span> <span class="pre">84</span> <span class="pre">or</span> <span class="pre">resi</span> <span class="pre">99)</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">(name</span> <span class="pre">O</span> <span class="pre">or</span> <span class="pre">name</span> <span class="pre">N)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">set_view</span> <span class="pre">(\</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">0.737348735,</span>&#160;&#160; <span class="pre">-0.664588213,</span>&#160;&#160; <span class="pre">-0.120811388,\</span>&#160;&#160;&#160;&#160; <span class="pre">-0.212751448,</span>&#160;&#160; <span class="pre">-0.398235619,</span>&#160;&#160;&#160; <span class="pre">0.892252982,\</span>&#160;&#160;&#160;&#160; <span class="pre">-0.641090214,</span>&#160;&#160; <span class="pre">-0.632204175,</span>&#160;&#160; <span class="pre">-0.435039639,\</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">0.000094488,</span>&#160;&#160;&#160; <span class="pre">0.001106668,</span>&#160; <span class="pre">-85.698837280,\</span>&#160;&#160;&#160;&#160; <span class="pre">30.798748016,</span>&#160;&#160;&#160; <span class="pre">4.481562614,</span>&#160;&#160;&#160; <span class="pre">6.916054726,\</span>&#160;&#160;&#160;&#160; <span class="pre">49.036270142,</span>&#160; <span class="pre">122.386810303,</span>&#160; <span class="pre">-20.000000000</span> <span class="pre">)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">deselect</span></code></p>
<p>The backbone has shifted just a little bit, but it’s enough to create some space between the new phenylalanine at position 99 and Leu 84.</p>
<p>To avoid writing all of this code, Rosetta developers have wrapped it up in a single protocol, known as Cartesian-ddG (since we are performing the minimization in Cartesian space). Cartesian-ddG is the current state of the art protocol for computing ddGs in Rosetta! Running Cartesian-ddG is outside of the scope of this exercise, but to showcase its utility I’ve run Cartesian-ddG on the 6 lysozyme mutants at position 99. We see a very nice correlation between the experimentally measured values and our computational predictions! Note that these <code class="docutils literal notranslate"><span class="pre">ddg_calc</span></code> values are unscaled, hence the integer values are different.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">dataset</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;cartesian_ddg_lysozyme.csv&#39;</span><span class="p">)</span>
           <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">mutation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">])))</span>
          <span class="p">)</span>
           
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;ddg_expt_protherm&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ddg_calc&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;experimental ΔΔG (kcal/mol)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;predicted ΔΔG (REU)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ddG_calc vs. ddG_expt for Lysozyme mutants at position 99&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;ddG_calc vs. ddG_expt for Lysozyme mutants at position 99&#39;)
</pre></div>
</div>
<img alt="_images/ddg_exercise_28_1.png" src="_images/ddg_exercise_28_1.png" />
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="papers.html" title="previous page">Additional Readings</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Kortemme Lab<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>